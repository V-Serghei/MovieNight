@model MovieNight.Web.Models.Movie.MovieTemplateInfModel

@{
ViewBag.Title = @Model.Title;
}
<link href="https://vjs.zencdn.net/7.18.1/video-js.css" rel="stylesheet" />

<div>
    <div class="content">
        <div class="container-fluid">
            <div class="row">
                <div class="col-12">
                    <div class="page-title-box">
                        <div class="page-title-right">
                            <ol class="breadcrumb m-0">
                                <li class="breadcrumb-item"><a href="javascript: void(0);">MovieNight</a></li>
                                <li class="breadcrumb-item" name="Category" value="1"><a href="javascript: void(0);">@Model.Title</a></li>
                                <input type="hidden" name="Category" value="1" />
                            </ol>
                        </div>
                        <h4 class="page-title">@Model.Title</h4>
                    </div>
                </div>
            </div>

            <style>
                .video-wrapper {
                    width: 100%;
                    max-width: 100%;
                    background-color: #000;
                    border-radius: 10px;
                    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
                    overflow: hidden;
                    position: relative;
                }

                .video-js .vjs-control-bar {
                    font-size: 16px;
                }

                .video-js .vjs-play-control,
                .video-js .vjs-volume-panel,
                .video-js .vjs-mute-control,
                .video-js .vjs-fullscreen-control {
                    font-size: 20px;
                }

                .video-js .vjs-control {
                    color: #fff;
                }

                .video-js .vjs-menu-button-popup .vjs-menu {
                    background-color: rgba(0, 0, 0, 0.8);
                }

                .video-js .vjs-menu-item:hover,
                .video-js .vjs-menu-item:focus {
                    background-color: rgba(255, 255, 255, 0.1);
                }

                .vjs-icon-download:before {
                    content: "\f019";
                    font-family: 'FontAwesome';
                }

                .vjs-icon-cog:before {
                    content: "\f013";
                    font-family: 'FontAwesome';
                }

                .vjs-icon-more-options:before {
                    content: "\f141";
                    font-family: 'FontAwesome';
                }

                .vjs-icon-download,
                .vjs-icon-cog,
                .vjs-icon-more-options {
                    color: #fff;
                    font-size: 20px;
                }

                .vjs-icon-download:hover,
                .vjs-icon-cog:hover,
                .vjs-icon-more-options:hover {
                    color: #ddd;
                }

                .vjs-big-play-centered .vjs-big-play-button {
                    top: 50%;
                    left: 50%;
                    margin-top: -1.5em;
                    margin-left: -1.5em;
                    position: absolute;
                    font-size: 3em;
                }

                .vjs-options-menu {
                    position: absolute;
                    top: 10px;
                    right: 10px;
                    background-color: rgba(0, 0, 0, 0.8);
                    border-radius: 5px;
                    padding: 10px;
                    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
                    display: none;
                    z-index: 1000;
                }

                .vjs-options-menu button,
                .vjs-options-menu a {
                    display: block;
                    width: 100%;
                    background: none;
                    border: none;
                    color: #fff;
                    font-size: 16px;
                    padding: 10px;
                    text-align: left;
                    cursor: pointer;
                    text-decoration: none;
                }

                .vjs-options-menu button:hover,
                .vjs-options-menu a:hover {
                    background-color: rgba(255, 255, 255, 0.1);
                }
            </style>

            <div class="row">
                <div class="col-12">
                    <div class="video-wrapper">
                        <video
                            id="videoPlayer"
                            class="video-js vjs-default-skin vjs-big-play-centered"
                            controls
                            preload="auto"
                            width="100%"
                            height="auto"
                            poster="@Url.Content(Model.PosterImage)"
                            data-setup='{"fluid": true}'
                        >
                            <source src="~/Video/viedeo_Test.mp4" type="video/mp4">
                            Your browser does not support the video tag.
                        </video>
                        <div class="vjs-options-menu" id="optionsMenu">
                            <button onclick="changePlaybackRate(0.5)">Speed: 0.5x</button>
                            <button onclick="changePlaybackRate(1)">Speed: 1x</button>
                            <button onclick="changePlaybackRate(1.5)">Speed: 1.5x</button>
                            <button onclick="togglePiP()">Picture in Picture</button>
                            <a href="~/Video/viedeo_Test.mp4" download>Download</a>
                        </div>
                        <div class="video-title">@Model.Title</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="https://vjs.zencdn.net/7.18.1/video.min.js"></script>
<script>
    var player = videojs('videoPlayer');

    player.ready(function() {
        var Button = videojs.getComponent('Button');

        var MoreOptionsButton = videojs.extend(Button, {
            constructor: function() {
                Button.apply(this, arguments);
                this.controlText("More Options");
                this.addClass("vjs-icon-more-options");
            },
            handleClick: function() {
                var optionsMenu = document.getElementById('optionsMenu');
                if (optionsMenu.style.display === 'block') {
                    optionsMenu.style.display = 'none';
                } else {
                    optionsMenu.style.display = 'block';
                }
            }
        });

        player.getChild('controlBar').addChild(new MoreOptionsButton(), {}, 10);
    });

    function changePlaybackRate(rate) {
        var video = document.getElementById('videoPlayer_html5_api');
        video.playbackRate = rate;
    }

    function togglePiP() {
        var video = document.getElementById('videoPlayer_html5_api');
        if (document.pictureInPictureElement) {
            document.exitPictureInPicture();
        } else {
            video.requestPictureInPicture();
        }
    }

    document.addEventListener('click', function(event) {
        var optionsMenu = document.getElementById('optionsMenu');
        var moreOptionsButton = document.querySelector('.vjs-icon-more-options');

        if (!optionsMenu.contains(event.target) && !moreOptionsButton.contains(event.target)) {
            optionsMenu.style.display = 'none';
        }
    });
</script>
